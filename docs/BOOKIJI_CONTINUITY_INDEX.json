{
    "version": "11.0",
    "lastUpdated": "2025-01-23",
    "purpose": "Machine-readable continuity kernel for Bookiji OS architecture, Genome, Linter, Agents, and Development Phases.",
    
    "architecture": {
      "core": {
        "description": "Next.js + Supabase + Stripe booking system, schedules, providers, messaging, admin UIs.",
        "runtimeRequirements": [
          "Must operate independently of n8n and LangChain.",
          "Event emitter must fire on all critical mutations.",
          "Supabase is the canonical persistence layer."
        ]
      },
      "eventEmitter": {
        "mandatoryEvents": [
          "booking.created",
          "booking.updated",
          "booking.cancelled",
          "refund.processed",
          "provider.updated",
          "dispute.opened",
          "dispute.resolved",
          "message.sent",
          "anomaly.detected",
          "ops.incident.created"
        ],
        "requirements": [
          "Async",
          "Idempotent",
          "Zero coupling to listeners",
          "Guaranteed delivery attempt"
        ]
      },
      "n8n": {
        "type": "optional",
        "mustNotBlockRuntime": true,
        "purposes": [
          "Notifications",
          "Fallback communication",
          "Data syncing",
          "Enrichment automation",
          "Help Center flows"
        ]
      },
      "opsAI": {
        "roles": [
          "SLO monitoring",
          "Latency metrics",
          "Anomaly detection",
          "Correlation engine",
          "Incident reasoning"
        ],
        "mustReceiveEvents": true
      },
      "simCity": {
        "roles": [
          "Synthetic bookings",
          "Chaos testing",
          "Time-machine",
          "Scenario playback",
          "Regression harness"
        ],
        "mustReceiveEvents": true
      },
      "supportingSystems": {
        "helpCenter": {
          "required": true,
          "features": [
            "Ticket classifier",
            "Article matcher",
            "Resolution trees",
            "Dispute summarizer",
            "Sentiment routing",
            "Escalation pathways"
          ]
        },
        "auditTrail": {
          "required": true,
          "features": [
            "Immutable logs",
            "Timeline snapshots",
            "State diffs",
            "Replay engine for OpsAI"
          ]
        },
        "notifications": {
          "version": "2.0",
          "required": true,
          "features": [
            "SMS/email/push delivery",
            "Quiet hours",
            "Retry chain",
            "Dead-letter queue"
          ]
        },
        "trustSafety": {
          "required": true,
          "features": [
            "Fraud detection",
            "Provider reliability",
            "Risk scoring",
            "Cancellation pattern analysis"
          ]
        },
        "biLayer": {
          "required": true,
          "features": [
            "Funnels",
            "Revenue projections",
            "Anomaly heatmaps",
            "Provider KPIs"
          ]
        }
      }
    },
  
    "genome": {
      "files": [
        "genome/master-genome.yaml",
        "genome/linter-rules.md"
      ],
      "domains": [
        "core",
        "events",
        "temporal",
        "opsai",
        "simcity",
        "helpCenter",
        "notifications",
        "trustSafety",
        "bi",
        "governance",
        "evolution"
      ],
      "policy": {
        "readOnly": true,
        "enforcedByLinter": true,
        "ciRequired": true
      }
    },
  
    "linter": {
      "location": "src/genome/",
      "rules": {
        "errorsBlockCI": true,
        "warningsAllowed": true,
        "validators": [
          "validateCore",
          "validateEvents",
          "validateTemporal",
          "validateOpsAI",
          "validateSimCity",
          "validateHelpCenter",
          "validateNotifications",
          "validateTrustSafety",
          "validateBI",
          "validateGovernance",
          "validateEvolution"
        ]
      },
      "cli": {
        "commands": [
          "pnpm genome:validate",
          "pnpm genome:explain"
        ]
      }
    },
  
    "agents": {
      "n8n": {
        "critical": false,
        "notes": "Bookiji must run normally if n8n is offline."
      },
      "langChain": {
        "critical": false,
        "roles": [
          "Help Center reasoning",
          "Semantic search",
          "OpsAI augmentation"
        ],
        "constraints": [
          "May not block runtime",
          "May not modify core logic",
          "Used only after event emission"
        ]
      },
      "cursor": {
        "mustFollow": [
          "Genome structure",
          "Linter guidance",
          "Development phases",
          "Architectural constraints",
          "Event boundaries",
          "File structure rules"
        ],
        "forbidden": [
          "Runtime refactors not explicitly requested",
          "Deleting modules without Genome updates",
          "Cross-domain coupling"
        ]
      },
      "chatGPT": {
        "role": "Architectural reasoning + continuity management",
        "responsibilities": [
          "Phase planning",
          "Architecture enforcement",
          "Context rehydration",
          "Design governance"
        ]
      }
    },
  
    "phases": {
      "current": "1.4",
      "completed": ["1.1", "1.2", "1.3"],
      "upcoming": ["2.0", "3.0", "4.0", "5.0", "6.0", "7.0", "8.0", "9.0"]
    },
  
    "constraints": {
      "runtimeMustNot": [
        "Depend on n8n",
        "Depend on LangChain",
        "Skip event emission",
        "Skip OpsAI ingest",
        "Skip SimCity ingest"
      ],
      "cursorMustNot": [
        "Refactor outside declared scope",
        "Modify runtime during test-only tasks",
        "Infer structural mutations"
      ]
    },
  
    "carryOverPrompt": {
      "text": "Load the Bookiji Continuity Kernel from docs/BOOKIJI_CONTINUITY_KERNEL.md and Canvas. Resume where we left off. We are currently at Phase __. Maintain all rules and boundaries. Continue."
    }
  }

